# Copyright (c) 2023 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#
"""Unit tests for cmd_image.py implementation."""

import pytest

from suit_generator.cmd_image import ImageCreator, EnvelopeStorage
from suit_generator.cmd_image import main as cmd_image_main
from suit_generator.exceptions import GeneratorError, SUITError

from unittest.mock import _Call

MAX_CACHE_COUNT = 16

addresses = {0x00000000: b"\x00\x00\x00\x00", 0xDEADBEEF: b"\xEF\xBE\xAD\xDE", 0xFFFFFFFF: b"\xFF\xFF\xFF\xFF"}
sizes = {0x00000000: b"\x00\x00\x00\x00", 0x01020304: b"\x04\x03\x02\x01", 0xFFFFFFFF: b"\xFF\xFF\xFF\xFF"}

signed_envelope_without_class_id_input = (
    b"\xd8k\xa4\x02Xs\x82X$\x82/X \xf1:\x80\x8f\xa3\x16)\x95\xd4G\xd3\xde\xe8\r\xa6\xb6\n\xcc\x03"
    b"\xb8m\xdc{\x12Z\x9b\xe5\x9e\xa0\xddL]XJ\xd2\x84C\xa1\x01&\xa0\xf6X@0!\n\xd4\xb7=\x13\xfc\xbaF"
    b"*\xb02\xa7p\xb5s\x83@6}\x96Q\x1d\xdc\xb3)\x07@<0\x99\xd7J\x1c\xaa\x8f_6\xf3\x08\xaa\xa7\xde"
    b"\x8fG\xedJ\xdd\xcdO^!$\x94\xa2U\xad\xb4\xb6\x8bC\xa8S\x03X\xba\xa7\x01\x01\x02\x01\x03Xo\xa2"
    b"\x02\x81\x84DcMEMA\x02E\x1a\x0e\n\xa0\x00E\x1a\x00\x05`\x00\x04XU\x86\x14\xa4\x01Pv\x17\xda"
    b"\xa5q\xfdZ\x85\x8f\x94\xe2\x8ds\\\xe9\xf4\x02P\x08\xc1\xb5\x99U\xe8_\xbc\x9ev{\xc2\x9c\xe1\xb0"
    b"M\x03X$\x82/X fhz\xad\xf8b\xbdwl\x8f\xc1\x8b\x8e\x9f\x8e \x08\x97\x14\x85n\xe23\xb3\x90*Y\x1d"
    b"\r_)%\x0e\x18 \x01\x0f\x02\x0f\x07C\x82\x03\x0f\tC\x82\x17\x02\x11R\x86\x14\xa1\x15i#file.bin"
    b"\x15\x02\x03\x0f\x17\x82/X \xd6%\x82'\x08\xfb\x1b\x18x\x8c\x98waBt\xf0\x966\xa7\xe0yN\xbd\x87"
    b"\x9b\xa1\x90*\xf1K8\x05\x17X\x97\xa1\x84DcMEMA\x02E\x1a\x0e\n\xa0\x00E\x1a\x00\x05`\x00\xa6"
    b"\x01x\x18Nordic Semiconductor ASA\x02onRF54H20_cpuapp\x03nnordicsemi.com\x04x\x1dThe nRF54H20"
    b" application core\x05x\x1aSample application core FW\x06fv1.0.0i#file.binX \x00\x00\x00\x00"
    b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
    b"\x00\x00\x00\x00\x00"
)
signed_envelope_input = (
    b"\xd8k\xa4\x02Xs\x82X$\x82/X ,\xb17i\xebj\xb3f \x95'\x0e\\\xa6\x8f\xc0\xb5\x9fnd\xf32\xa1)k<"
    b"\xe0\x8e\x9a\xcaO\x7fXJ\xd2\x84C\xa1\x01&\xa0\xf6X@\x1d\x8e\xc1h\xbd\x91\xa5\xb3C5\xb6V=xI\x80"
    b"#\xd9\xd6\xbdh~\xd2\x8a\xa8:\xd7zg\xbf#\x87\x00k\x7f\"\x88V'\x99\xb3\x08ITi\x04\x0e0\xe9A@:"
    b"\xafB\xfd\x16\xd1\xe3\x1cS\x17$\x97\xab\x03X\xda\xa8\x01\x01\x02\x01\x03Xo\xa2\x02\x81\x84DcME"
    b"MA\x02E\x1a\x0e\n\xa0\x00E\x1a\x00\x05`\x00\x04XU\x86\x14\xa4\x01Pv\x17\xda\xa5q\xfdZ\x85\x8f"
    b"\x94\xe2\x8ds\\\xe9\xf4\x02P\x08\xc1\xb5\x99U\xe8_\xbc\x9ev{\xc2\x9c\xe1\xb0M\x03X$\x82/X fhz"
    b"\xad\xf8b\xbdwl\x8f\xc1\x8b\x8e\x9f\x8e \x08\x97\x14\x85n\xe23\xb3\x90*Y\x1d\r_)%\x0e\x18 \x01"
    b"\x0f\x02\x0f\x07C\x82\x03\x0f\tC\x82\x17\x02\x11R\x86\x14\xa1\x15i#file.bin\x15\x02\x03\x0f"
    b"\x17\x82/X \xd6%\x82'\x08\xfb\x1b\x18x\x8c\x98waBt\xf0\x966\xa7\xe0yN\xbd\x87\x9b\xa1\x90*\xf1"
    b"K8\x05\x05\x82LkINSTLD_MFSTP\x08\xc1\xb5\x99U\xe8_\xbc\x9ev{\xc2\x9c\xe1\xb0M\x17X\x97\xa1\x84"
    b"DcMEMA\x02E\x1a\x0e\n\xa0\x00E\x1a\x00\x05`\x00\xa6\x01x\x18Nordic Semiconductor ASA\x02onRF54"
    b"H20_cpuapp\x03nnordicsemi.com\x04x\x1dThe nRF54H20 application core\x05x\x1aSample application"
    b" core FW\x06fv1.0.0i#file.binX \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
    b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
)
malformed_envelope_input = b"\x00"

expected_boot_storage = (
    ":020000040E1ECE\n"
    ":10EC0000AA55AA5500000000000000000000000006\n"
    ":10EC100000000000000000000000000000000000F4\n"
    ":10EC200000000000000000000000000000000000E4\n"
    ":10ED8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF93\n"
    ":10ED9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF83\n"
    ":10EDA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF73\n"
    ":10EDB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF63\n"
    ":10EDC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF53\n"
    ":10EDD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF43\n"
    ":10EDE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF33\n"
    ":10EDF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF23\n"
    ":10EE0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF12\n"
    ":10EE1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF02\n"
    ":10EE2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2\n"
    ":10EE3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE2\n"
    ":10EE4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD2\n"
    ":10EE5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC2\n"
    ":10EE6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB2\n"
    ":10EE7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA2\n"
    ":10EE8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF92\n"
    ":10EE9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF82\n"
    ":10EEA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF72\n"
    ":10EEB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF62\n"
    ":10EEC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF52\n"
    ":10EED000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF42\n"
    ":10EEE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF32\n"
    ":10EEF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF22\n"
    ":10EF0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF11\n"
    ":10EF1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF01\n"
    ":10EF2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1\n"
    ":10EF3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE1\n"
    ":10EF4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD1\n"
    ":10EF5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC1\n"
    ":10EF6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB1\n"
    ":10EF7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA1\n"
    ":10EF8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF91\n"
    ":10EF9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF81\n"
    ":10EFA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF71\n"
    ":10EFB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF61\n"
    ":10EFC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF51\n"
    ":10EFD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF41\n"
    ":10EFE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF31\n"
    ":10EFF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF21\n"
    ":10F00000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF10\n"
    ":10F01000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00\n"
    ":10F02000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0\n"
    ":10F03000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE0\n"
    ":10F04000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD0\n"
    ":10F05000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC0\n"
    ":10F06000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB0\n"
    ":10F07000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA0\n"
    ":10F08000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF90\n"
    ":10F09000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF80\n"
    ":10F0A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70\n"
    ":10F0B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF60\n"
    ":10F0C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF50\n"
    ":10F0D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF40\n"
    ":10F0E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF30\n"
    ":10F0F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF20\n"
    ":10F10000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0F\n"
    ":10F11000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n"
    ":10F12000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEF\n"
    ":10F13000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDF\n"
    ":10F14000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCF\n"
    ":10F15000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBF\n"
    ":10F16000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAF\n"
    ":10F17000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9F\n"
    ":10F18000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8F\n"
    ":10F19000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7F\n"
    ":10F1A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6F\n"
    ":10F1B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5F\n"
    ":10F1C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4F\n"
    ":10F1D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3F\n"
    ":10F1E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2F\n"
    ":10F1F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1F\n"
    ":10F20000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0E\n"
    ":10F21000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE\n"
    ":10F22000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEE\n"
    ":10F23000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDE\n"
    ":10F24000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCE\n"
    ":10F25000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBE\n"
    ":10F26000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAE\n"
    ":10F27000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9E\n"
    ":10F28000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8E\n"
    ":10F29000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7E\n"
    ":10F2A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6E\n"
    ":10F2B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5E\n"
    ":10F2C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4E\n"
    ":10F2D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3E\n"
    ":10F2E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2E\n"
    ":10F2F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1E\n"
    ":10F30000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0D\n"
    ":10F31000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD\n"
    ":10F32000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFED\n"
    ":10F33000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDD\n"
    ":10F34000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCD\n"
    ":10F35000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBD\n"
    ":10F36000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAD\n"
    ":10F37000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9D\n"
    ":10F38000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8D\n"
    ":10F39000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7D\n"
    ":10F3A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6D\n"
    ":10F3B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D\n"
    ":10F3C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4D\n"
    ":10F3D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3D\n"
    ":10F3E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2D\n"
    ":10F3F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1D\n"
    ":10F40000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0C\n"
    ":10F41000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC\n"
    ":10F42000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEC\n"
    ":10F43000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC\n"
    ":10F44000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCC\n"
    ":10F45000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBC\n"
    ":10F46000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAC\n"
    ":10F47000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9C\n"
    ":10F48000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8C\n"
    ":10F49000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7C\n"
    ":10F4A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6C\n"
    ":10F4B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5C\n"
    ":10F4C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4C\n"
    ":10F4D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3C\n"
    ":10F4E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2C\n"
    ":10F4F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1C\n"
    ":10F50000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0B\n"
    ":10F51000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB\n"
    ":10F52000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEB\n"
    ":10F53000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDB\n"
    ":10F54000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCB\n"
    ":10F55000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBB\n"
    ":10F56000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAB\n"
    ":10F57000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9B\n"
    ":10F58000A300010119014602590156D86BA2025885\n"
    ":10F5900073825824822F58202CB13769EB6AB366E6\n"
    ":10F5A0002095270E5CA68FC0B59F6E64F332A1290B\n"
    ":10F5B0006B3CE08E9ACA4F7F584AD28443A1012601\n"
    ":10F5C000A0F658401D8EC168BD91A5B34335B6560F\n"
    ":10F5D0003D78498023D9D6BD687ED28AA83AD77AA9\n"
    ":10F5E00067BF2387006B7F2288562799B308495449\n"
    ":10F5F00069040E30E941403AAF42FD16D1E31C5395\n"
    ":10F60000172497AB0358DAA80101020103586FA22F\n"
    ":10F6100002818444634D454D4102451A0E0AA00003\n"
    ":10F62000451A000560000458558614A40150761749\n"
    ":10F63000DAA571FD5A858F94E28D735CE9F402506E\n"
    ":10F6400008C1B59955E85FBC9E767BC29CE1B04D80\n"
    ":10F65000035824822F582066687AADF862BD776C13\n"
    ":10F660008FC18B8E9F8E20089714856EE233B390E6\n"
    ":10F670002A591D0D5F29250E1820010F020F07437F\n"
    ":10F6800082030F094382170211528614A1156923C0\n"
    ":10F6900066696C652E62696E1502030F17822F581A\n"
    ":10F6A00020D625822708FB1B18788C987761427436\n"
    ":10F6B000F09636A7E0794EBD879BA1902AF14B3892\n"
    ":10F6C0000505824C6B494E53544C445F4D46535490\n"
    ":10F6D0005008C1B59955E85FBC9E767BC29CE1B0ED\n"
    ":10F6E0004DFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC\n"
    ":10F6F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1A\n"
    ":10F70000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF09\n"
    ":10F71000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9\n"
    ":10F72000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE9\n"
    ":10F73000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD9\n"
    ":10F74000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC9\n"
    ":10F75000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB9\n"
    ":10F76000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA9\n"
    ":10F77000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF99\n"
    ":10F78000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF89\n"
    ":10F79000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF79\n"
    ":10F7A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF69\n"
    ":10F7B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF59\n"
    ":10F7C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF49\n"
    ":10F7D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF39\n"
    ":10F7E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF29\n"
    ":10F7F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF19\n"
    ":10F80000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF08\n"
    ":10F81000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8\n"
    ":10F82000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE8\n"
    ":10F83000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD8\n"
    ":10F84000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC8\n"
    ":10F85000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB8\n"
    ":10F86000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA8\n"
    ":10F87000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF98\n"
    ":10F88000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF88\n"
    ":10F89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF78\n"
    ":10F8A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF68\n"
    ":10F8B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF58\n"
    ":10F8C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF48\n"
    ":10F8D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF38\n"
    ":10F8E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF28\n"
    ":10F8F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF18\n"
    ":10F90000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF07\n"
    ":10F91000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7\n"
    ":10F92000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE7\n"
    ":10F93000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD7\n"
    ":10F94000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7\n"
    ":10F95000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB7\n"
    ":10F96000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA7\n"
    ":10F97000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF97\n"
    ":10F98000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF87\n"
    ":10F99000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF77\n"
    ":10F9A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF67\n"
    ":10F9B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF57\n"
    ":10F9C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF47\n"
    ":10F9D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF37\n"
    ":10F9E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF27\n"
    ":10F9F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF17\n"
    ":10FA0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF06\n"
    ":10FA1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6\n"
    ":10FA2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE6\n"
    ":10FA3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD6\n"
    ":10FA4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC6\n"
    ":10FA5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB6\n"
    ":10FA6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA6\n"
    ":10FA7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF96\n"
    ":10FA8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF86\n"
    ":10FA9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF76\n"
    ":10FAA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF66\n"
    ":10FAB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF56\n"
    ":10FAC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF46\n"
    ":10FAD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF36\n"
    ":10FAE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF26\n"
    ":10FAF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF16\n"
    ":10FB0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF05\n"
    ":10FB1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5\n"
    ":10FB2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE5\n"
    ":10FB3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD5\n"
    ":10FB4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC5\n"
    ":10FB5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB5\n"
    ":10FB6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA5\n"
    ":10FB7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF95\n"
    ":10FB8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF85\n"
    ":10FB9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF75\n"
    ":10FBA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF65\n"
    ":10FBB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF55\n"
    ":10FBC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF45\n"
    ":10FBD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF35\n"
    ":10FBE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF25\n"
    ":10FBF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF15\n"
    ":10FC0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF04\n"
    ":10FC1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4\n"
    ":10FC2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE4\n"
    ":10FC3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD4\n"
    ":10FC4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC4\n"
    ":10FC5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB4\n"
    ":10FC6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA4\n"
    ":10FC7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF94\n"
    ":10FC8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF84\n"
    ":10FC9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF74\n"
    ":10FCA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF64\n"
    ":10FCB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF54\n"
    ":10FCC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF44\n"
    ":10FCD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF34\n"
    ":10FCE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF24\n"
    ":10FCF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF14\n"
    ":10FD0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF03\n"
    ":10FD1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3\n"
    ":10FD2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE3\n"
    ":10FD3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD3\n"
    ":10FD4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC3\n"
    ":10FD5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB3\n"
    ":10FD6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA3\n"
    ":10FD7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF93\n"
    ":10FD8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF83\n"
    ":10FD9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF73\n"
    ":10FDA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF63\n"
    ":10FDB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF53\n"
    ":10FDC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF43\n"
    ":10FDD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF33\n"
    ":10FDE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF23\n"
    ":10FDF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF13\n"
    ":10FE0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF02\n"
    ":10FE1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2\n"
    ":10FE2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE2\n"
    ":10FE3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD2\n"
    ":10FE4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC2\n"
    ":10FE5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB2\n"
    ":10FE6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA2\n"
    ":10FE7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF92\n"
    ":10FE8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF82\n"
    ":10FE9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF72\n"
    ":10FEA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF62\n"
    ":10FEB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF52\n"
    ":10FEC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF42\n"
    ":10FED000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF32\n"
    ":10FEE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF22\n"
    ":10FEF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF12\n"
    ":10FF0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF01\n"
    ":10FF1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1\n"
    ":10FF2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE1\n"
    ":10FF3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD1\n"
    ":10FF4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC1\n"
    ":10FF5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB1\n"
    ":10FF6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA1\n"
    ":10FF7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF91\n"
    ":10FF8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF81\n"
    ":10FF9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF71\n"
    ":10FFA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF61\n"
    ":10FFB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF51\n"
    ":10FFC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF41\n"
    ":10FFD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF31\n"
    ":10FFE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF21\n"
    ":10FFF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF11\n"
    ":020000040E1FCD\n"
    ":10000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00\n"
    ":10001000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0\n"
    ":10002000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE0\n"
    ":10003000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD0\n"
    ":10004000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC0\n"
    ":10005000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB0\n"
    ":10006000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA0\n"
    ":10007000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF90\n"
    ":10008000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF80\n"
    ":10009000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70\n"
    ":1000A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF60\n"
    ":1000B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF50\n"
    ":1000C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF40\n"
    ":1000D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF30\n"
    ":1000E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF20\n"
    ":1000F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF10\n"
    ":10010000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n"
    ":10011000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEF\n"
    ":10012000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDF\n"
    ":10013000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCF\n"
    ":10014000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBF\n"
    ":10015000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAF\n"
    ":10016000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9F\n"
    ":10017000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8F\n"
    ":10018000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7F\n"
    ":10019000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6F\n"
    ":1001A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5F\n"
    ":1001B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4F\n"
    ":1001C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3F\n"
    ":1001D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2F\n"
    ":1001E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1F\n"
    ":1001F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0F\n"
    ":10020000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE\n"
    ":10021000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEE\n"
    ":10022000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDE\n"
    ":10023000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCE\n"
    ":10024000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBE\n"
    ":10025000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAE\n"
    ":10026000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9E\n"
    ":10027000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8E\n"
    ":10028000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7E\n"
    ":10029000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6E\n"
    ":1002A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5E\n"
    ":1002B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4E\n"
    ":1002C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3E\n"
    ":1002D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2E\n"
    ":1002E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1E\n"
    ":1002F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0E\n"
    ":10030000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD\n"
    ":10031000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFED\n"
    ":10032000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDD\n"
    ":10033000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCD\n"
    ":10034000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBD\n"
    ":10035000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAD\n"
    ":10036000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9D\n"
    ":10037000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8D\n"
    ":10038000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7D\n"
    ":10039000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6D\n"
    ":1003A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D\n"
    ":1003B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4D\n"
    ":1003C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3D\n"
    ":1003D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2D\n"
    ":1003E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1D\n"
    ":1003F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0D\n"
    ":10040000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC\n"
    ":10041000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEC\n"
    ":10042000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC\n"
    ":10043000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCC\n"
    ":10044000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBC\n"
    ":10045000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAC\n"
    ":10046000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9C\n"
    ":10047000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8C\n"
    ":10048000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7C\n"
    ":10049000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6C\n"
    ":1004A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5C\n"
    ":1004B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4C\n"
    ":1004C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3C\n"
    ":1004D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2C\n"
    ":1004E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1C\n"
    ":1004F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0C\n"
    ":10050000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB\n"
    ":10051000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEB\n"
    ":10052000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDB\n"
    ":10053000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCB\n"
    ":10054000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBB\n"
    ":10055000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAB\n"
    ":10056000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9B\n"
    ":10057000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8B\n"
    ":10058000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7B\n"
    ":10059000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6B\n"
    ":1005A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5B\n"
    ":1005B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4B\n"
    ":1005C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3B\n"
    ":1005D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2B\n"
    ":1005E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1B\n"
    ":1005F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0B\n"
    ":10060000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA\n"
    ":10061000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEA\n"
    ":10062000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDA\n"
    ":10063000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCA\n"
    ":10064000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBA\n"
    ":10065000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAA\n"
    ":10066000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9A\n"
    ":10067000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8A\n"
    ":10068000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7A\n"
    ":10069000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6A\n"
    ":1006A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5A\n"
    ":1006B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4A\n"
    ":1006C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3A\n"
    ":1006D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2A\n"
    ":1006E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1A\n"
    ":1006F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0A\n"
    ":10070000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9\n"
    ":10071000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE9\n"
    ":10072000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD9\n"
    ":10073000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC9\n"
    ":10074000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB9\n"
    ":10075000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA9\n"
    ":10076000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF99\n"
    ":10077000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF89\n"
    ":10078000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF79\n"
    ":10079000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF69\n"
    ":1007A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF59\n"
    ":1007B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF49\n"
    ":1007C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF39\n"
    ":1007D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF29\n"
    ":1007E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF19\n"
    ":1007F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF09\n"
    ":10080000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8\n"
    ":10081000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE8\n"
    ":10082000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD8\n"
    ":10083000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC8\n"
    ":10084000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB8\n"
    ":10085000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA8\n"
    ":10086000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF98\n"
    ":10087000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF88\n"
    ":10088000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF78\n"
    ":10089000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF68\n"
    ":1008A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF58\n"
    ":1008B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF48\n"
    ":1008C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF38\n"
    ":1008D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF28\n"
    ":1008E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF18\n"
    ":1008F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF08\n"
    ":10090000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7\n"
    ":10091000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE7\n"
    ":10092000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD7\n"
    ":10093000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7\n"
    ":10094000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB7\n"
    ":10095000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA7\n"
    ":10096000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF97\n"
    ":10097000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF87\n"
    ":10098000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF77\n"
    ":10099000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF67\n"
    ":1009A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF57\n"
    ":1009B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF47\n"
    ":1009C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF37\n"
    ":1009D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF27\n"
    ":1009E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF17\n"
    ":1009F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF07\n"
    ":100A0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6\n"
    ":100A1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE6\n"
    ":100A2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD6\n"
    ":100A3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC6\n"
    ":100A4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB6\n"
    ":100A5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA6\n"
    ":100A6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF96\n"
    ":100A7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF86\n"
    ":100A8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF76\n"
    ":100A9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF66\n"
    ":100AA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF56\n"
    ":100AB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF46\n"
    ":100AC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF36\n"
    ":100AD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF26\n"
    ":100AE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF16\n"
    ":100AF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF06\n"
    ":100B0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5\n"
    ":100B1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE5\n"
    ":100B2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD5\n"
    ":100B3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC5\n"
    ":100B4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB5\n"
    ":100B5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA5\n"
    ":100B6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF95\n"
    ":100B7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF85\n"
    ":100B8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF75\n"
    ":100B9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF65\n"
    ":100BA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF55\n"
    ":100BB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF45\n"
    ":100BC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF35\n"
    ":100BD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF25\n"
    ":100BE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF15\n"
    ":100BF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF05\n"
    ":100C0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4\n"
    ":100C1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE4\n"
    ":100C2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD4\n"
    ":100C3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC4\n"
    ":100C4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB4\n"
    ":100C5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA4\n"
    ":100C6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF94\n"
    ":100C7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF84\n"
    ":100C8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF74\n"
    ":100C9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF64\n"
    ":100CA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF54\n"
    ":100CB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF44\n"
    ":100CC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF34\n"
    ":100CD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF24\n"
    ":100CE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF14\n"
    ":100CF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF04\n"
    ":100D0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3\n"
    ":100D1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE3\n"
    ":100D2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD3\n"
    ":100D3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC3\n"
    ":100D4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB3\n"
    ":100D5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA3\n"
    ":100D6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF93\n"
    ":100D7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF83\n"
    ":100D8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF73\n"
    ":100D9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF63\n"
    ":100DA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF53\n"
    ":100DB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF43\n"
    ":100DC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF33\n"
    ":100DD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF23\n"
    ":100DE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF13\n"
    ":100DF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF03\n"
    ":100E0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2\n"
    ":100E1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE2\n"
    ":100E2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD2\n"
    ":100E3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC2\n"
    ":100E4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB2\n"
    ":100E5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA2\n"
    ":100E6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF92\n"
    ":100E7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF82\n"
    ":100E8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF72\n"
    ":100E9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF62\n"
    ":100EA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF52\n"
    ":100EB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF42\n"
    ":100EC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF32\n"
    ":100ED000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF22\n"
    ":100EE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF12\n"
    ":100EF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF02\n"
    ":100F0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1\n"
    ":100F1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE1\n"
    ":100F2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD1\n"
    ":100F3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC1\n"
    ":100F4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB1\n"
    ":100F5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA1\n"
    ":100F6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF91\n"
    ":100F7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF81\n"
    ":100F8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF71\n"
    ":100F9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF61\n"
    ":100FA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF51\n"
    ":100FB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF41\n"
    ":100FC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF31\n"
    ":100FD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF21\n"
    ":100FE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF11\n"
    ":100FF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF01\n"
    ":10100000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0\n"
    ":10101000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE0\n"
    ":10102000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD0\n"
    ":10103000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC0\n"
    ":10104000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB0\n"
    ":10105000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA0\n"
    ":10106000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF90\n"
    ":10107000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF80\n"
    ":10108000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70\n"
    ":10109000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF60\n"
    ":1010A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF50\n"
    ":1010B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF40\n"
    ":1010C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF30\n"
    ":1010D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF20\n"
    ":1010E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF10\n"
    ":1010F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00\n"
    ":10110000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEF\n"
    ":10111000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDF\n"
    ":10112000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCF\n"
    ":10113000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBF\n"
    ":10114000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAF\n"
    ":10115000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9F\n"
    ":10116000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8F\n"
    ":10117000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7F\n"
    ":10118000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6F\n"
    ":10119000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5F\n"
    ":1011A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4F\n"
    ":1011B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3F\n"
    ":1011C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2F\n"
    ":1011D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1F\n"
    ":1011E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0F\n"
    ":1011F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n"
    ":10120000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEE\n"
    ":10121000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDE\n"
    ":10122000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCE\n"
    ":10123000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBE\n"
    ":10124000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAE\n"
    ":10125000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9E\n"
    ":10126000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8E\n"
    ":10127000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7E\n"
    ":10128000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6E\n"
    ":10129000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5E\n"
    ":1012A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4E\n"
    ":1012B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3E\n"
    ":1012C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2E\n"
    ":1012D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1E\n"
    ":1012E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0E\n"
    ":1012F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE\n"
    ":10130000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFED\n"
    ":10131000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDD\n"
    ":10132000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCD\n"
    ":10133000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBD\n"
    ":10134000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAD\n"
    ":10135000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9D\n"
    ":10136000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8D\n"
    ":10137000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7D\n"
    ":10138000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6D\n"
    ":10139000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D\n"
    ":1013A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4D\n"
    ":1013B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3D\n"
    ":1013C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2D\n"
    ":1013D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1D\n"
    ":1013E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0D\n"
    ":1013F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD\n"
    ":10140000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEC\n"
    ":10141000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC\n"
    ":10142000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCC\n"
    ":10143000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBC\n"
    ":10144000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAC\n"
    ":10145000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9C\n"
    ":10146000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8C\n"
    ":10147000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7C\n"
    ":10148000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6C\n"
    ":10149000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5C\n"
    ":1014A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4C\n"
    ":1014B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3C\n"
    ":1014C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2C\n"
    ":1014D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1C\n"
    ":1014E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0C\n"
    ":1014F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC\n"
    ":10150000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEB\n"
    ":10151000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDB\n"
    ":10152000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCB\n"
    ":10153000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBB\n"
    ":10154000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAB\n"
    ":10155000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9B\n"
    ":10156000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8B\n"
    ":10157000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7B\n"
    ":10158000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6B\n"
    ":10159000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5B\n"
    ":1015A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4B\n"
    ":1015B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3B\n"
    ":1015C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2B\n"
    ":1015D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1B\n"
    ":1015E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0B\n"
    ":1015F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB\n"
    ":10160000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEA\n"
    ":10161000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDA\n"
    ":10162000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCA\n"
    ":10163000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBA\n"
    ":10164000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAA\n"
    ":10165000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9A\n"
    ":10166000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8A\n"
    ":10167000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7A\n"
    ":10168000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6A\n"
    ":10169000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5A\n"
    ":1016A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4A\n"
    ":1016B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3A\n"
    ":1016C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2A\n"
    ":1016D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1A\n"
    ":1016E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0A\n"
    ":1016F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA\n"
    ":10170000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE9\n"
    ":10171000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD9\n"
    ":10172000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC9\n"
    ":10173000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB9\n"
    ":10174000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA9\n"
    ":10175000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF99\n"
    ":10176000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF89\n"
    ":10177000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF79\n"
    ":10178000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF69\n"
    ":10179000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF59\n"
    ":1017A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF49\n"
    ":1017B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF39\n"
    ":1017C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF29\n"
    ":1017D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF19\n"
    ":1017E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF09\n"
    ":1017F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9\n"
    ":10180000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE8\n"
    ":10181000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD8\n"
    ":10182000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC8\n"
    ":10183000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB8\n"
    ":10184000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA8\n"
    ":10185000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF98\n"
    ":10186000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF88\n"
    ":10187000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF78\n"
    ":10188000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF68\n"
    ":10189000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF58\n"
    ":1018A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF48\n"
    ":1018B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF38\n"
    ":1018C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF28\n"
    ":1018D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF18\n"
    ":1018E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF08\n"
    ":1018F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8\n"
    ":10190000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE7\n"
    ":10191000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD7\n"
    ":10192000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7\n"
    ":10193000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB7\n"
    ":10194000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA7\n"
    ":10195000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF97\n"
    ":10196000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF87\n"
    ":10197000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF77\n"
    ":10198000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF67\n"
    ":10199000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF57\n"
    ":1019A000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF47\n"
    ":1019B000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF37\n"
    ":1019C000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF27\n"
    ":1019D000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF17\n"
    ":1019E000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF07\n"
    ":1019F000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7\n"
    ":101A0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE6\n"
    ":101A1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD6\n"
    ":101A2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC6\n"
    ":101A3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB6\n"
    ":101A4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA6\n"
    ":101A5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF96\n"
    ":101A6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF86\n"
    ":101A7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF76\n"
    ":101A8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF66\n"
    ":101A9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF56\n"
    ":101AA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF46\n"
    ":101AB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF36\n"
    ":101AC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF26\n"
    ":101AD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF16\n"
    ":101AE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF06\n"
    ":101AF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6\n"
    ":101B0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE5\n"
    ":101B1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD5\n"
    ":101B2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC5\n"
    ":101B3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB5\n"
    ":101B4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA5\n"
    ":101B5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF95\n"
    ":101B6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF85\n"
    ":101B7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF75\n"
    ":101B8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF65\n"
    ":101B9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF55\n"
    ":101BA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF45\n"
    ":101BB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF35\n"
    ":101BC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF25\n"
    ":101BD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF15\n"
    ":101BE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF05\n"
    ":101BF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5\n"
    ":101C0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE4\n"
    ":101C1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD4\n"
    ":101C2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC4\n"
    ":101C3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB4\n"
    ":101C4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA4\n"
    ":101C5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF94\n"
    ":101C6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF84\n"
    ":101C7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF74\n"
    ":101C8000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF64\n"
    ":101C9000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF54\n"
    ":101CA000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF44\n"
    ":101CB000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF34\n"
    ":101CC000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF24\n"
    ":101CD000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF14\n"
    ":101CE000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF04\n"
    ":101CF000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4\n"
    ":101D0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE3\n"
    ":101D1000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD3\n"
    ":101D2000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC3\n"
    ":101D3000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB3\n"
    ":101D4000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA3\n"
    ":101D5000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF93\n"
    ":101D6000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF83\n"
    ":101D7000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF73\n"
    ":00000001FF\n"
)

expected_update_storage = (
    ":020000040E1ECE\n"
    ":10EC0000AA55AA55010000000000100E1C020000C9\n"
    ":10EC100000000000000000000000000000000000F4\n"
    ":10EC200000000000000000000000000000000000E4\n"
    ":00000001FF\n"
)
expected_update_dfu_partition = (
    ":020000040E10DC\n"
    ":10000000D86BA4025873825824822F58202CB13701\n"
    ":1000100069EB6AB3662095270E5CA68FC0B59F6E0C\n"
    ":1000200064F332A1296B3CE08E9ACA4F7F584AD2C2\n"
    ":100030008443A10126A0F658401D8EC168BD91A53C\n"
    ":10004000B34335B6563D78498023D9D6BD687ED2B4\n"
    ":100050008AA83AD77A67BF2387006B7F2288562702\n"
    ":1000600099B308495469040E30E941403AAF42FD62\n"
    ":1000700016D1E31C53172497AB0358DAA8010102E9\n"
    ":100080000103586FA202818444634D454D410245EE\n"
    ":100090001A0E0AA000451A0005600004585586147F\n"
    ":1000A000A401507617DAA571FD5A858F94E28D73FD\n"
    ":1000B0005CE9F4025008C1B59955E85FBC9E767BB7\n"
    ":1000C000C29CE1B04D035824822F582066687AAD57\n"
    ":1000D000F862BD776C8FC18B8E9F8E200897148538\n"
    ":1000E0006EE233B3902A591D0D5F29250E182001A9\n"
    ":1000F0000F020F074382030F094382170211528632\n"
    ":1001000014A115692366696C652E62696E15020378\n"
    ":100110000F17822F5820D625822708FB1B18788CB2\n"
    ":100120009877614274F09636A7E0794EBD879BA11F\n"
    ":10013000902AF14B380505824C6B494E53544C4480\n"
    ":100140005F4D4653545008C1B59955E85FBC9E7643\n"
    ":100150007BC29CE1B04D175897A18444634D454D37\n"
    ":100160004102451A0E0AA000451A00056000A601CA\n"
    ":1001700078184E6F726469632053656D69636F6EA2\n"
    ":10018000647563746F7220415341026F6E5246353D\n"
    ":10019000344832305F637075617070036E6E6F72D9\n"
    ":1001A00064696373656D692E636F6D04781D5468AF\n"
    ":1001B00065206E52463534483230206170706C696B\n"
    ":1001C000636174696F6E20636F726505781A53619D\n"
    ":1001D0006D706C65206170706C69636174696F6EBD\n"
    ":1001E00020636F7265204657066676312E302E30BA\n"
    ":1001F000692366696C652E62696E582000000000F4\n"
    ":1002000000000000000000000000000000000000EE\n"
    ":0C021000000000000000000000000000E2\n"
    ":00000001FF\n"
)


def prepare_calls(data):
    """Split data by lines and wrap each line using _Call object for easy assertions; get rid of last newline"""
    return [_Call(("", (f"{line}\n",))) for line in data.split("\n")[:-1]]


@pytest.mark.parametrize("nb_of_caches", range(MAX_CACHE_COUNT + 1))
def test_struct_format(nb_of_caches):
    caches_format = "II" * nb_of_caches
    format = "<IIII" + caches_format
    assert ImageCreator._prepare_suit_storage_struct_format(nb_of_caches) == format


@pytest.mark.parametrize("nb_of_caches", range(MAX_CACHE_COUNT + 1))
def test_update_candidate_info_for_boot(nb_of_caches):
    suit_storage_bytes = b"\xAA\x55\xAA\x55\x00\x00\x00\x00"
    envelope_address_size_bytes = b"\x00\x00\x00\x00\x00\x00\x00\x00"
    caches_bytes = b"\x00\x00\x00\x00\x00\x00\x00\x00" * nb_of_caches

    expected_bytes = suit_storage_bytes + envelope_address_size_bytes + caches_bytes

    assert ImageCreator._prepare_update_candidate_info_for_boot(nb_of_caches) == expected_bytes


def test_update_candidate_info_verify_class_id_offset():
    from suit_generator.envelope import SuitEnvelope
    from suit_generator.suit.envelope import SuitEnvelopeTagged
    from cbor2 import loads as cbor_loads

    # Generate envlope object
    envelope = SuitEnvelope()
    envelope._envelope = SuitEnvelopeTagged.from_cbor(signed_envelope_input).to_obj()

    # Generate storage envelope slot for the envelope
    storage = EnvelopeStorage(0)
    storage.add_envelope(envelope)
    (envelope_role, envelope_cbor) = storage._envelopes.popitem()

    # Extract the class ID, based on the offset and minified envelope
    storage_dict = cbor_loads(envelope_cbor)
    offset = storage_dict[EnvelopeStorage.ENVELOPE_SLOT_CLASS_ID_OFFSET_KEY]
    envelope_bstr = storage_dict[EnvelopeStorage.ENVELOPE_SLOT_ENVELOPE_BSTR_KEY]

    # RFC4122 uuid5(nordic_vid, 'nRF54H20_sample_app')
    exp_class_id = b"\x08\xc1\xb5\x99\x55\xe8\x5f\xbc\x9e\x76\x7b\xc2\x9c\xe1\xb0\x4d"

    assert envelope_bstr[offset : offset + 16] == exp_class_id


@pytest.mark.parametrize("nb_of_caches", range(MAX_CACHE_COUNT + 1))
@pytest.mark.parametrize("address", addresses)
@pytest.mark.parametrize("size", sizes)
def test_update_candidate_info_for_update(address, size, nb_of_caches):
    magic_bytes = b"\xAA\x55\xAA\x55"
    nregions_bytes = b"\x01\x00\x00\x00"
    address_bytes = addresses[address]
    size_bytes = sizes[size]

    suit_storage_bytes = magic_bytes + nregions_bytes + address_bytes + size_bytes

    caches_bytes = b"\x00\x00\x00\x00\x00\x00\x00\x00" * nb_of_caches

    expected_bytes = suit_storage_bytes + caches_bytes

    assert ImageCreator._prepare_update_candidate_info_for_update(address, size, nb_of_caches) == expected_bytes


def test_unsupported_image_subcommand():
    with pytest.raises(GeneratorError):
        cmd_image_main(
            image="unsupported",
            input_file="",
            storage_output_file="",
            update_candidate_info_address=0,
            envelope_address=0,
            dfu_partition_output_file="",
            dfu_partition_address=0,
            dfu_max_caches=0,
        )


def test_boot_subcommand_nonexisting_input_file():
    with pytest.raises(GeneratorError):
        cmd_image_main(
            image="boot",
            input_file=["nonexisting"],
            storage_output_file="",
            update_candidate_info_address=0,
            envelope_address=0,
            envelope_slot_size=2048,
            envelope_slot_count=8,
            dfu_partition_output_file="",
            dfu_partition_address=0,
            dfu_max_caches=0,
        )


def test_boot_subcommand_manifest_without_component_id(mocker):
    io_mock = mocker.mock_open(read_data=signed_envelope_without_class_id_input)
    mocker.patch("builtins.open", io_mock)

    with pytest.raises(GeneratorError):
        cmd_image_main(
            image="boot",
            input_file=["some_input"],
            storage_output_file="some_output.hex",
            update_candidate_info_address=0x0E1EEC00,
            envelope_address=0x0E1EED80,
            envelope_slot_size=2048,
            envelope_slot_count=8,
            dfu_partition_output_file="",
            dfu_partition_address=0,
            dfu_max_caches=4,
        )


def test_boot_subcommand_success(mocker):
    io_mock = mocker.mock_open(read_data=signed_envelope_input)
    mocker.patch("builtins.open", io_mock)

    cmd_image_main(
        image="boot",
        input_file=["some_input"],
        storage_output_file="some_output.hex",
        update_candidate_info_address=0x0E1EEC00,
        envelope_address=0x0E1EED80,
        envelope_slot_size=2048,
        envelope_slot_count=1,
        dfu_partition_output_file="",
        dfu_partition_address=0,
        dfu_max_caches=4,
    )

    io_mock().read.assert_called_once()
    io_mock().write.assert_has_calls(prepare_calls(expected_boot_storage))


def test_update_subcommand_nonexisting_input_file():
    with pytest.raises(GeneratorError):
        cmd_image_main(
            image="update",
            input_file="nonexisting",
            storage_output_file="",
            update_candidate_info_address=0,
            envelope_address=0,
            dfu_partition_output_file="",
            dfu_partition_address=0,
            dfu_max_caches=0,
        )


def test_update_subcommand_success(mocker):
    io_mock = mocker.mock_open(read_data=signed_envelope_input)

    mocker.patch("builtins.open", io_mock)

    getsize_mock = mocker.Mock()
    getsize_mock.side_effect = lambda _: len(signed_envelope_input)
    mocker.patch("os.path.getsize", getsize_mock)

    cmd_image_main(
        image="update",
        input_file="some_input",
        storage_output_file="some_storage_output",
        update_candidate_info_address=0x0E1EEC00,
        envelope_address=0x0E1EED80,
        dfu_partition_output_file="some_dfu_partition_output",
        dfu_partition_address=0x0E100000,
        dfu_max_caches=4,
    )

    expected_calls = prepare_calls(expected_update_storage) + prepare_calls(expected_update_dfu_partition)

    io_mock().read.assert_called_once()
    io_mock().write.assert_has_calls(expected_calls)


def test_malformed_envelope(mocker):
    io_mock = mocker.mock_open(read_data=malformed_envelope_input)
    mocker.patch("builtins.open", io_mock)

    with pytest.raises(SUITError):
        cmd_image_main(
            image="boot",
            input_file=["some_input"],
            storage_output_file="some_output.hex",
            update_candidate_info_address=0x0E1FE000,
            envelope_address=0x0E1FF000,
            envelope_slot_size=2048,
            envelope_slot_count=8,
            dfu_partition_output_file="",
            dfu_partition_address=0,
            dfu_max_caches=0,
        )


def test_bin2hex_conversion_error(mocker, monkeypatch):
    io_mock = mocker.mock_open(read_data=signed_envelope_input)

    mocker.patch("builtins.open", io_mock)

    getsize_mock = mocker.Mock()
    getsize_mock.side_effect = lambda _: len(signed_envelope_input)
    mocker.patch("os.path.getsize", getsize_mock)

    def bin2hex_mock(*args, **kwargs):
        """Helper function to return non-zero error code"""
        return 42

    # The intuitive way would be to use 'mocker.patch("intelhex.bin2hex", ...)' but it doesn't mock the bin2hex function
    # when it is imported in tested code by 'from intelhex import bin2hex'.
    # The approach below allows to patch the function regardless of how it is imported in tested code.
    monkeypatch.setattr("intelhex.bin2hex.__code__", bin2hex_mock.__code__)

    with pytest.raises(GeneratorError):
        cmd_image_main(
            image="update",
            input_file="some_input",
            storage_output_file="some_storage_output",
            update_candidate_info_address=0x0E1EEC00,
            envelope_address=0x0E1EED80,
            dfu_partition_output_file="some_dfu_partition_output",
            dfu_partition_address=0x0E100000,
            dfu_max_caches=4,
        )
